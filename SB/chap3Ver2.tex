\section{点群からの形状再現}
本章では，点群からの形状再現について述べる．
	\subsection{誤差の定式化}
		本研究における誤差の定式化について述べる．本研究における誤差とは，ある点群集合$ \bd{P}_{\mathrm{set}} $に属する点$ \bd{p}_i $と曲面との最小距離，つまり，
		\begin{equation}\label{eq:error_eq}
			e_i = \min_{s,t} |\bd{p}_i - \bd{S}(s,t)|^2
		\end{equation}
		と定義する．この式はパラメータ$ s,t $に関する最適化問題として捉えられ，$ s\in [0,L],t \in[0,D(s)] $の定義域内で求める必要がある．こうした求めた$ e_i $の総和$ E =\sum_{i=0}^{N} e_i$を，曲面と点群との誤差として捉える．点群から曲面を生成するためには，この$ E $を最小化するような曲面を生成する必要がある．
		
		この目的関数$ E $は，1回あたりの評価に対して$ \forall \bd{p} \in \bd{P}_{\mathrm{set}}$に対して\ref{eq:error_eq}の最適化問題を解く必要がある．しかし，そのまま最適化手法を用いて解いてしまうと計算時間が膨大になってしまい，計算結果を得られるまで非常に時間がかかってしまう．そこで本研究では，$ e $の計算過程において，幾何的な性質を用いることで，探索効率を上げる方法について述べる．
		
		まず，$ e $の停留条件を求める．
		\begin{equation}\label{eq:e_diff_regarding_s}
			\partdf{e}{s} = 0
		\end{equation}
		
		\begin{equation}\label{eq:e_diff_regarding_t}
			\partdf{e}{t} = 0
		\end{equation}
		となる．\ref{eq:e_diff_regarding_t}について解けば
		\begin{equation}\label{eq:t_eq}
			t^* = \bd{d}_g \cdot (\bd{p} - \bd{x}_L(s))
		\end{equation}
		を得られる．これを\ref{eq:e_diff_regarding_s}に代入すれば，パラメータ$s $に関する非線形方程式として解けば，解を求めることができる．解を求める際のアルゴリズムには，ニュートン法や二分法，Brent法などが存在する．しかし，ニュートン法の場合においては，初期解によって解に探索性が非常に悪くなる可能性が知られている他，二分法やBrent法においては，解の探索区間$x \in [a,b] $における$ f(x) = 0$を考える場合に，$ f(a)f(b)\leq 0 $を要求する．こうした条件を必ず\ref{eq:e_diff_regarding_s}が満たすとは限らない．
		こうした問題を解決し，数値的に安定に目的関数を計算するため，誤差が最小になる際の幾何学的条件について考える．本研究における誤差$ 0 $の状態とは，$ \bd{p} $が曲面上に存在している，つまり$ \bd{\eta}\cdot(\bd{p} - \bd{S})=0 $を満たすような点である．この意味で考えると，$ \bd{p} - \bd{S} $のノルムが誤差を表すベクトルであるための十分条件は，$ \bd{\eta} $と平行であることである．すなわち$ \bd{d}_1 \cdot (\bd{p} - \bd{S}) = 0 $および$ \bd{d}_2 \cdot (\bd{p} - \bd{S}) = 0 $が成り立つ．
		
		%図
		
		このうち，$ \bd{d}_2 \cdot (\bd{p} - \bd{S}) = 0 $については，\ref{eq:t_eq}と同じ結果を得る．したがって，\ref{eq:t_eq}を$ \bd{d}_1 \cdot (\bd{p} - \bd{S}) $に代入した関数を$ f(s) $とおき，$ s $について適当な探索アルゴリズムを用いて解けばよい．このような形式で表現することで，式がシンプルに表現できるほか，曲面がなめらかである場合においては，$ \bd{d}_1 $が反転したりすることがないため，二分法の適用条件を満たす可能性を高めることができる．
	\subsection{点群の条件分け}
		次に，点群を複数枚の可展面で表現する場合における手法について示す．前提として，表現される可展面の枚数$ n_c $は決定されているとする．効率よく目的関数を求めるためには，点群がどの曲面で評価されるべきかを領域分けする必要がある．本研究では，図に示すように，２つの境界線を持つ可展面が，$ G0 $接続で接続されている形状によって目的形状を表現することについて考える．
		
		%図1枚目
		
		この時，点群の境界上に1つの曲線が与えられるとすれば，その曲線に基づいて誤差を最小化する曲面を$ \bd{S}_{d,1} $として，以下のようなアルゴリズムを提案する．
		%algorithm図
		
		まずはじめに，$ \bd{S}_{d,k} $における誤差最小化が行われる時のパラメータ$ (s,t) $について求める．この時，得られたパラメータ$ s $に対する曲面の母線長を$ t_{\max} $とおく．
		\begin{enumerate}
			\item $ t^* \leq t_{\max} $の場合，図に示すように点群は曲面の定義域内に存在する可能性が高い．つまり，そのまま1枚目の曲面で判断されるべきであると判定する
			\item $ t^* > t_{\max} $の場合，図に示すように$\bd{p} $は，曲面の外側に存在する可能性が高い，つまり，$ k+1 $番目の可展面で評価されるべきである．
		\end{enumerate}
		上記の作業を，$ k $を$ 1 $から$ n_c-1 $まで繰り返すことで，複数枚の可展面で覆われた曲面を定義できる．
		